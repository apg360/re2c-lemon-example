/* Generated by re2c 2.0.3 on Tue Dec 29 00:52:44 2020 */
#line 1 "scanner.re"
#define _GNU_SOURCE
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define _IN_SCANNER
#include "scanner.h"
 
#if 0
#define DEBUG(stmt) stmt
#else
#define DEBUG(stmt)
#endif
 
int scan(scanner_state *s, scanner_token *token) {
//  char *cursor = s->start;
    int r=SCANNER_RETCODE_IMPOSSIBLE;
    char *q=s->start;//keep initial start
#define YYCTYPE     char
#define YYCURSOR    (s->start)
#define YYLIMIT     (s->end)
 
    while(SCANNER_RETCODE_IMPOSSIBLE == r) {

#line 27 "scanner.c"
		{
			YYCTYPE yych;
			yych = *YYCURSOR;
			switch (yych) {
			case 0x00:	goto yy2;
			case '(':	goto yy6;
			case ')':	goto yy8;
			case '*':	goto yy10;
			case '+':	goto yy12;
			case '-':	goto yy14;
			case '/':	goto yy16;
			case '0':
			case '1':
			case '2':
			case '3':
			case '4':
			case '5':
			case '6':
			case '7':
			case '8':
			case '9':	goto yy18;
			default:	goto yy4;
			}
yy2:
			++YYCURSOR;
#line 68 "scanner.re"
			{ r = SCANNER_RETCODE_EOF; break; }
#line 55 "scanner.c"
yy4:
			++YYCURSOR;
#line 69 "scanner.re"
			{ r = SCANNER_RETCODE_ERR; break; }
#line 60 "scanner.c"
yy6:
			++YYCURSOR;
#line 59 "scanner.re"
			{
                token->opcode = TOKEN_ROUND_BRACKET_OPEN;
                return 0;
            }
#line 68 "scanner.c"
yy8:
			++YYCURSOR;
#line 63 "scanner.re"
			{
                token->opcode = TOKEN_ROUND_BRACKET_CLOSE;
                return 0;
            }
#line 76 "scanner.c"
yy10:
			++YYCURSOR;
#line 51 "scanner.re"
			{
                token->opcode = TOKEN_MUL;
                return 0;
            }
#line 84 "scanner.c"
yy12:
			++YYCURSOR;
#line 43 "scanner.re"
			{
                token->opcode = TOKEN_ADD;
                return 0;
            }
#line 92 "scanner.c"
yy14:
			++YYCURSOR;
#line 47 "scanner.re"
			{
                token->opcode = TOKEN_SUB;
                return 0;
            }
#line 100 "scanner.c"
yy16:
			++YYCURSOR;
#line 55 "scanner.re"
			{
                token->opcode = TOKEN_DIV;
                return 0;
            }
#line 108 "scanner.c"
yy18:
			yych = *++YYCURSOR;
			switch (yych) {
			case '0':
			case '1':
			case '2':
			case '3':
			case '4':
			case '5':
			case '6':
			case '7':
			case '8':
			case '9':	goto yy18;
			default:	goto yy20;
			}
yy20:
#line 30 "scanner.re"
			{
                char *num;
                int n;
                num = strndup(q,YYCURSOR - q);
                n = atoi(num);
                DEBUG(printf("scanner num: '%s', YYCURSOR: '%s' YYLIMIT: '%s' q: '%s'\n",num,YYCURSOR,YYLIMIT,q));
                free(num);
                q = YYCURSOR;
            //  DEBUG(printf("integer, cursor: %s, number len: %ld, number: %d\n",YYCURSOR,YYCURSOR-s->start,n));
                token->data.n = n;
                token->opcode = TOKEN_INTEGER;
                return 0;
            }
#line 139 "scanner.c"
		}
#line 70 "scanner.re"

    }
    return r;
}
